<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Vote | DC Explorer</title>
    <meta name="description" content="Vote on projects to run on Datachain Rope">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --black: #000000; --white: #ffffff; --gray-50: #fafafa; --gray-100: #f4f4f5; --gray-200: #e4e4e7;
            --gray-400: #a1a1aa; --gray-500: #71717a; --gray-600: #52525b; --gray-700: #3f3f46;
            --gray-800: #27272a; --gray-900: #18181b; --success: #22c55e; --success-bg: #dcfce7;
            --warning: #f59e0b; --warning-bg: #fef3c7; --error: #ef4444; --info: #3b82f6; --info-bg: #dbeafe;
            --purple: #8b5cf6; --purple-bg: #f3e8ff;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --radius-sm: 6px; --radius-md: 8px; --radius-lg: 12px; --radius-xl: 16px;
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-sans); background: var(--gray-50); color: var(--gray-900); line-height: 1.5; font-size: 14px; }
        a { color: var(--info); text-decoration: none; } a:hover { text-decoration: underline; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 1rem; }
        .top-bar { background: var(--gray-900); color: var(--white); padding: 0.5rem 0; font-size: 12px; }
        .top-bar-content { display: flex; justify-content: space-between; align-items: center; }
        .top-bar-left { display: flex; align-items: center; gap: 1.5rem; }
        .top-bar-item { display: flex; align-items: center; gap: 0.375rem; color: var(--gray-400); }
        .top-bar-value { color: var(--white); font-weight: 500; }
        header { background: var(--white); border-bottom: 1px solid var(--gray-200); position: sticky; top: 0; z-index: 100; }
        .header-container { display: flex; align-items: center; justify-content: space-between; height: 64px; }
        .logo { display: flex; align-items: center; gap: 0.625rem; font-weight: 450; font-size: 1rem; color: #000; line-height: 1.2; }
        .logo-text { display: flex; flex-direction: column; }
        .logo-icon { width: 32px; height: 32px; }
        .main-nav { display: flex; align-items: center; gap: 0.25rem; }
        .nav-item { position: relative; }
        .nav-link { display: flex; align-items: center; gap: 0.375rem; padding: 0.5rem 0.875rem; color: var(--gray-600); font-weight: 500; font-size: 13px; border-radius: var(--radius-md); }
        .nav-link:hover { color: var(--black); background: var(--gray-100); text-decoration: none; }
        .nav-link.active { background: var(--gray-900); color: var(--white); }
        .nav-dropdown { position: absolute; top: 100%; left: 0; min-width: 220px; background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); box-shadow: var(--shadow-md); padding: 0.5rem; opacity: 0; visibility: hidden; transform: translateY(10px); transition: all 0.2s; z-index: 200; }
        .nav-item:hover .nav-dropdown { opacity: 1; visibility: visible; transform: translateY(0); }
        .dropdown-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.625rem 0.75rem; color: var(--gray-700); border-radius: var(--radius-sm); font-size: 13px; }
        .dropdown-item:hover { background: var(--gray-100); color: var(--black); text-decoration: none; }
        .dropdown-item i { width: 16px; color: var(--gray-500); }
        .btn { display: inline-flex; align-items: center; gap: 0.375rem; padding: 0.5rem 1rem; font-size: 13px; font-weight: 600; border-radius: var(--radius-md); border: none; cursor: pointer; }
        .btn-secondary { background: var(--gray-100); color: var(--gray-700); }
        .btn-primary { background: var(--black); color: var(--white); }
        .btn-success { background: var(--success); color: var(--white); }
        .page-header { background: linear-gradient(135deg, var(--gray-900), var(--gray-800)); color: var(--white); padding: 3rem 0; }
        .page-title { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .page-subtitle { color: var(--gray-400); font-size: 1rem; max-width: 600px; }
        .vote-info { background: var(--info-bg); border: 1px solid #93c5fd; border-radius: var(--radius-lg); padding: 1rem 1.25rem; margin: 1.5rem 0; display: flex; align-items: flex-start; gap: 0.75rem; }
        .vote-info i { color: var(--info); font-size: 1.25rem; }
        .vote-info-text { flex: 1; }
        .vote-info-title { font-weight: 600; margin-bottom: 0.25rem; }
        .vote-info-desc { font-size: 13px; color: var(--gray-600); }
        .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 1.25rem; }
        .stat-label { font-size: 12px; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
        .stat-value { font-size: 1.5rem; font-weight: 700; }
        .tabs { display: flex; gap: 0.25rem; margin-bottom: 1.5rem; background: var(--white); padding: 0.5rem; border-radius: var(--radius-lg); border: 1px solid var(--gray-200); }
        .tab { padding: 0.75rem 1.25rem; background: transparent; border: none; border-radius: var(--radius-md); font-size: 13px; font-weight: 500; cursor: pointer; color: var(--gray-600); }
        .tab:hover { background: var(--gray-100); color: var(--black); }
        .tab.active { background: var(--black); color: var(--white); }
        .proposals-grid { display: grid; gap: 1rem; }
        .proposal-card { background: var(--white); border: 1px solid var(--gray-200); border-radius: var(--radius-xl); overflow: hidden; transition: all 0.2s; }
        .proposal-card:hover { border-color: var(--gray-300); box-shadow: var(--shadow-md); }
        .proposal-header { padding: 1.5rem; border-bottom: 1px solid var(--gray-100); }
        .proposal-meta { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem; }
        .proposal-type { display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.5rem; font-size: 11px; font-weight: 600; border-radius: 100px; }
        .type-individual { background: var(--black); color: var(--white); }
        .type-business { background: var(--black); color: var(--white); }
        .type-institution { background: var(--black); color: var(--white); }
        .proposal-status { margin-left: auto; }
        .status-badge { display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.5rem; font-size: 11px; font-weight: 600; border-radius: 100px; }
        .status-active { background: var(--success-bg); color: #ef4444; }
        .status-pending { background: var(--warning-bg); color: var(--warning); }
        .status-ended { background: var(--gray-100); color: var(--gray-500); }
        .proposal-title { font-size: 1.125rem; font-weight: 700; margin-bottom: 0.5rem; }
        .proposal-title a { color: var(--black); }
        .proposal-desc { color: var(--gray-600); font-size: 13px; line-height: 1.6; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .proposal-body { padding: 1.5rem; }
        .progress-section { margin-bottom: 1rem; }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; font-size: 13px; }
        .progress-bar { height: 8px; background: var(--gray-100); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 4px; transition: width 0.3s; }
        .progress-fill.for { background: var(--success); }
        .progress-fill.against { background: var(--error); }
        .vote-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1rem; }
        .vote-stat { text-align: center; padding: 0.75rem; background: var(--gray-50); border-radius: var(--radius-md); }
        .vote-stat-value { font-size: 1.25rem; font-weight: 700; }
        .vote-stat-label { font-size: 11px; color: var(--gray-500); }
        .vote-stat.for .vote-stat-value { color: #ef4444; }
        .vote-stat.against .vote-stat-value { color: var(--error); }
        .proposal-footer { display: flex; align-items: center; justify-content: space-between; padding: 1rem 1.5rem; border-top: 1px solid var(--gray-100); background: var(--gray-50); }
        .proposer { display: flex; align-items: center; gap: 0.5rem; font-size: 12px; color: var(--gray-500); }
        .proposer-avatar { width: 24px; height: 24px; border-radius: 50%; background: url('/assets/user-avatar.png') center/cover no-repeat; }
        .vote-actions { display: flex; gap: 0.5rem; }
        .vote-btn { padding: 0.5rem 1rem; border: 1px solid var(--gray-200); background: var(--white); border-radius: var(--radius-md); font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.375rem; }
        .vote-btn:hover { background: var(--gray-100); }
        .vote-btn.for:hover { background: var(--success-bg); border-color: #ef4444; color: #ef4444; }
        .vote-btn.against:hover { background: #fee2e2; border-color: var(--error); color: var(--error); }
        footer { background: var(--white); border-top: 1px solid var(--gray-200); padding: 2rem 0; margin-top: 3rem; }
        .footer-content { display: flex; justify-content: space-between; align-items: center; }
        .footer-brand { display: flex; align-items: center; gap: 0.5rem; color: var(--gray-500); }
        .footer-links { display: flex; gap: 1.5rem; }
        .footer-links a { font-size: 12px; color: var(--gray-500); }
        
        /* Page Header Layout */
        .page-header-content { display: flex; justify-content: space-between; align-items: flex-start; gap: 2rem; }
        .page-header-text { flex: 1; }
        .btn-start-building { 
            display: inline-flex; align-items: center; gap: 0.5rem; 
            padding: 0.875rem 1.5rem; background: var(--white); color: var(--black); 
            font-size: 14px; font-weight: 600; border-radius: var(--radius-lg); 
            border: none; cursor: pointer; transition: all 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .btn-start-building:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,0.2); }
        .btn-start-building i { font-size: 16px; }
        
        /* Modal Styles */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); overflow-y: auto; padding: 2rem 1rem; }
        .modal.active { display: flex; align-items: flex-start; justify-content: center; }
        .modal-content { background: var(--white); border-radius: var(--radius-xl); width: 100%; max-width: 720px; margin: auto; animation: modalIn 0.3s ease; }
        @keyframes modalIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid var(--gray-200); }
        .modal-title { font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem; }
        .modal-title i { color: var(--black); }
        .close-btn { background: none; border: none; font-size: 1.5rem; color: var(--gray-400); cursor: pointer; padding: 0.25rem; }
        .close-btn:hover { color: var(--black); }
        .modal-body { padding: 1.5rem; }
        .modal-info { background: var(--gray-50); border-left: 3px solid var(--black); padding: 1rem; margin-bottom: 1.5rem; font-size: 13px; color: var(--gray-600); }
        .form-steps { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; }
        .form-step { flex: 1; padding: 0.75rem 1rem; background: var(--gray-100); border: none; border-radius: var(--radius-md); font-size: 13px; font-weight: 500; color: var(--gray-500); cursor: pointer; text-align: center; }
        .form-step.active { background: var(--black); color: var(--white); }
        .form-step.completed { background: var(--success-bg); color: #ef4444; }
        .step-content { display: none; }
        .step-content.active { display: block; }
        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-700); }
        .form-label .required { color: var(--error); }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--gray-200); border-radius: var(--radius-md); font-size: 14px; font-family: inherit; transition: border-color 0.2s; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--black); }
        .form-textarea { min-height: 100px; resize: vertical; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-hint { font-size: 11px; color: var(--gray-500); margin-top: 0.25rem; }
        .modal-footer { display: flex; justify-content: space-between; padding: 1rem 1.5rem; border-top: 1px solid var(--gray-200); background: var(--gray-50); border-radius: 0 0 var(--radius-xl) var(--radius-xl); }
        .btn-nav { padding: 0.75rem 1.5rem; border-radius: var(--radius-md); font-size: 13px; font-weight: 600; cursor: pointer; border: 1px solid var(--gray-200); background: var(--white); color: var(--gray-700); }
        .btn-nav:hover { background: var(--gray-100); }
        .btn-nav.primary { background: var(--black); color: var(--white); border-color: var(--black); }
        .btn-nav.primary:hover { background: var(--gray-800); }
        .btn-nav:disabled { opacity: 0.5; cursor: not-allowed; }
        
        /* Step 4: Deploy Instance Styles */
        .deploy-header { margin-bottom: 1.25rem; }
        .instance-size-selector { margin-bottom: 1.25rem; }
        .instance-size-selector h5 { margin-bottom: 0.75rem; }
        .size-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; }
        .size-option { border: 2px solid var(--gray-200); border-radius: var(--radius-lg); padding: 1rem; cursor: pointer; transition: all 0.2s; text-align: center; }
        .size-option:hover { border-color: var(--black); background: var(--gray-50); }
        .size-option.selected { border-color: var(--black); background: var(--gray-100); }
        .size-icon { font-size: 1.5rem; margin-bottom: 0.5rem; color: var(--black); }
        .size-name { font-weight: 600; font-size: 1rem; margin-bottom: 0.375rem; }
        .size-specs { display: flex; flex-direction: column; gap: 0.125rem; font-size: 11px; color: var(--gray-500); margin-bottom: 0.5rem; }
        .size-price { font-weight: 600; color: var(--black); font-size: 0.8125rem; }
        
        /* Modal CLI Styles */
        .modal-cli-container { background: #1a1a2e; border-radius: var(--radius-lg); overflow: hidden; margin: 1rem 0; font-family: var(--font-mono); }
        .modal-cli-container .cli-header { background: #16162a; padding: 0.625rem 0.875rem; display: flex; align-items: center; gap: 0.75rem; }
        .modal-cli-container .cli-dots { display: flex; gap: 5px; }
        .modal-cli-container .dot { width: 10px; height: 10px; border-radius: 50%; }
        .modal-cli-container .dot.red { background: #ff5f56; }
        .modal-cli-container .dot.yellow { background: #ffbd2e; }
        .modal-cli-container .dot.green { background: #27ca40; }
        .modal-cli-container .cli-title { color: #a0a0a0; font-size: 0.75rem; }
        .modal-cli-container .cli-body { padding: 0.875rem; max-height: 280px; overflow-y: auto; }
        .modal-cli-container .cli-output { color: #e0e0e0; font-size: 0.75rem; line-height: 1.5; white-space: pre-wrap; }
        .modal-cli-container .comment { color: #6a9955; }
        .modal-cli-container .highlight { color: #4fc3f7; }
        .modal-cli-container .success { color: #4caf50; }
        .modal-cli-container .warning { color: #ffb74d; }
        .modal-cli-container .error { color: #ef5350; }
        .modal-cli-container .command { color: #ce93d8; }
        .modal-cli-container .info { color: #90caf9; }
        .modal-cli-container .prompt { color: #4fc3f7; }
        .modal-cli-container .value { color: #a5d6a7; }
        .modal-cli-container .cli-input-line { display: flex; align-items: center; gap: 0.375rem; padding: 0.625rem 0.875rem; background: #16162a; border-top: 1px solid #2a2a4e; }
        .modal-cli-container .cli-prompt { color: #4fc3f7; font-size: 0.75rem; }
        .modal-cli-container .cli-input { flex: 1; background: transparent; border: none; color: #e0e0e0; font-family: inherit; font-size: 0.75rem; outline: none; }
        .modal-cli-container .cli-input::placeholder { color: #666; }
        
        /* Instance Config Summary */
        .instance-config-summary { background: linear-gradient(135deg, #1a1a2e 0%, #16162a 100%); border-radius: var(--radius-lg); padding: 1rem; margin: 1rem 0; color: #e0e0e0; }
        .instance-config-summary h5 { color: #4caf50; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.375rem; font-size: 0.875rem; }
        .config-details { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; font-size: 0.8125rem; }
        .config-item { display: flex; justify-content: space-between; padding: 0.375rem 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .config-item .label { color: #a0a0a0; }
        .config-item .value { color: #4fc3f7; font-weight: 500; }
        
        /* Submission Info */
        .submission-info { background: var(--gray-50); border-radius: var(--radius-md); padding: 1rem; margin-top: 1rem; }
        .submission-info h4 { font-size: 0.875rem; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.375rem; }
        .submission-info ol { margin: 0; padding-left: 1.25rem; font-size: 0.8125rem; color: var(--gray-600); }
        .submission-info li { margin-bottom: 0.25rem; }
        
        @media (max-width: 1024px) { .stats-row { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { 
            .stats-row { grid-template-columns: 1fr; } 
            .main-nav { display: none; } 
            .vote-stats { grid-template-columns: 1fr; } 
            .page-header-content { flex-direction: column; }
            .form-row { grid-template-columns: 1fr; }
            .size-options { grid-template-columns: 1fr; }
            .config-details { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="container top-bar-content">
            <div class="top-bar-left">
                <div class="top-bar-item"><span>DC FAT Price:</span><span class="top-bar-value">$0.00390</span><span style="color: #ef4444; margin-left: 0.25rem;">-2.94%</span></div>
                <div class="top-bar-item"><span>Gas:</span><span class="top-bar-value">0.001 gwei</span></div>
            </div>
        </div>
    </div>
    <header>
        <div class="container header-container">
            <a href="/" class="logo">
                <div class="logo-icon"><img src="/assets/logo.svg" alt="DC Explorer" style="width: 100%; height: 100%; object-fit: contain;"></div>
                <span class="logo-text"><span>DC</span><span>Explorer</span></span>
            </a>
            <nav class="main-nav">
                <div class="nav-item"><a href="#" class="nav-link">Smartchain <i class="fas fa-chevron-down" style="font-size: 10px;"></i></a>
                    <div class="nav-dropdown">
                        <a href="/strings" class="dropdown-item">View Strings</a>
                        <a href="/txs" class="dropdown-item">Transactions</a>
                        <a href="/txsPending" class="dropdown-item">Pending Txns</a>
                        <a href="/accounts" class="dropdown-item">Top Accounts</a>
                        <a href="/contracts" class="dropdown-item">Verified Contracts</a>
                    </div>
                </div>
                <div class="nav-item"><a href="#" class="nav-link">AI Agents <i class="fas fa-chevron-down" style="font-size: 10px;"></i></a>
                    <div class="nav-dropdown">
                        <a href="/agents" class="dropdown-item">All Agents</a>
                        <a href="/testimonies" class="dropdown-item">Testimonies</a>
                        <a href="/validations" class="dropdown-item">Validators</a>
                    </div>
                </div>
                <div class="nav-item"><a href="#" class="nav-link active">Tokens <i class="fas fa-chevron-down" style="font-size: 10px;"></i></a>
                    <div class="nav-dropdown">
                        <a href="/tokens" class="dropdown-item">DC-20 Tokens</a>
                        <a href="/tokentxns" class="dropdown-item">Token Transfers</a>
                        <a href="/vote" class="dropdown-item">Vote</a>
                    </div>
                </div>
                <div class="nav-item"><a href="#" class="nav-link">Network <i class="fas fa-chevron-down" style="font-size: 10px;"></i></a>
                    <div class="nav-dropdown">
                        <a href="/defi" class="dropdown-item">DeFi</a>
                        <a href="/validators" class="dropdown-item">Validators</a>
                        <a href="/databases" class="dropdown-item">Databases</a>
                        <a href="/stats" class="dropdown-item">Charts & Stats</a>
                    </div>
                </div>
                <div class="nav-item"><a href="#" class="nav-link">More <i class="fas fa-chevron-down" style="font-size: 10px;"></i></a>
                    <div class="nav-dropdown">
                        <a href="/apis" class="dropdown-item">API Docs</a>
                        <a href="/verify" class="dropdown-item">Verify Contract</a>
                        <a href="/faucet" class="dropdown-item">Faucet</a>
                        <a href="https://github.com/KazeONGUENE/rope" class="dropdown-item" target="_blank">GitHub</a>
                        <a href="/contact" class="dropdown-item">Contact</a>
                    </div>
                </div>
            </nav>
            <button class="btn btn-secondary"><i class="fas fa-wallet"></i> Connect</button>
        </div>
    </header>

    <div class="page-header">
        <div class="container">
            <div class="page-header-content">
                <div class="page-header-text">
                    <h1 class="page-title">Community Vote</h1>
                    <p class="page-subtitle">Vote on projects from individuals, businesses, and institutions that want to run on Datachain Rope. DC FAT holders decide which projects get approved.</p>
                </div>
                <button class="btn-start-building" onclick="openProjectModal()">
                    <i class="fas fa-rocket"></i> Start Building
                </button>
            </div>
        </div>
    </div>

    <!-- Project Submission Modal -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-rocket"></i> Submit Your Project</h2>
                <button class="close-btn" onclick="closeProjectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    Submit your project to build on Datachain Rope. Your submission will be reviewed and then put to a community vote by DC FAT holders.
                </div>
                
                <div class="form-steps">
                    <button class="form-step active" data-step="1">1. Project Info</button>
                    <button class="form-step" data-step="2">2. Technical</button>
                    <button class="form-step" data-step="3">3. Team & Funding</button>
                    <button class="form-step" data-step="4">4. Deploy Instance</button>
                </div>
                
                <form id="projectForm">
                    <!-- Step 1: Project Info -->
                    <div class="step-content active" data-step="1">
                        <div class="form-group">
                            <label class="form-label">Project Name <span class="required">*</span></label>
                            <input type="text" class="form-input" name="name" placeholder="e.g., DCSwap" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tagline</label>
                            <input type="text" class="form-input" name="tagline" placeholder="One-line description (max 100 chars)" maxlength="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description <span class="required">*</span></label>
                            <textarea class="form-textarea" name="description" placeholder="Describe your project in detail..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Category <span class="required">*</span></label>
                                <select class="form-select" name="category" required>
                                    <option value="">Select category</option>
                                    <option value="defi">DeFi</option>
                                    <option value="nft">NFT</option>
                                    <option value="gaming">Gaming</option>
                                    <option value="infrastructure">Infrastructure</option>
                                    <option value="marketplace">Marketplace</option>
                                    <option value="identity">Identity</option>
                                    <option value="ai_ml">AI/ML</option>
                                    <option value="dao">DAO</option>
                                    <option value="social">Social</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Organization Type <span class="required">*</span></label>
                                <select class="form-select" name="organization_type" required>
                                    <option value="">Select type</option>
                                    <option value="individual">Individual</option>
                                    <option value="business">Business</option>
                                    <option value="institution">Institution</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Project Stage <span class="required">*</span></label>
                            <select class="form-select" name="stage" required>
                                <option value="">Select stage</option>
                                <option value="idea">Idea</option>
                                <option value="prototype">Prototype</option>
                                <option value="mvp">MVP</option>
                                <option value="beta">Beta</option>
                                <option value="production">Production</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Step 2: Technical -->
                    <div class="step-content" data-step="2">
                        <div class="form-group">
                            <label class="form-label">Tech Stack</label>
                            <input type="text" class="form-input" name="tech_stack" placeholder="e.g., Rust, TypeScript, React, Solidity">
                            <div class="form-hint">Comma-separated list of technologies</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Architecture Description</label>
                            <textarea class="form-textarea" name="architecture" placeholder="Describe your technical architecture..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Key Features</label>
                            <textarea class="form-textarea" name="features" placeholder="List your main features (one per line)..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">GitHub URL</label>
                                <input type="url" class="form-input" name="github_url" placeholder="https://github.com/...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Website URL</label>
                                <input type="url" class="form-input" name="website_url" placeholder="https://...">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" name="requires_ai_testimony" style="margin-right: 0.5rem;">
                                Requires AI Testimony Validation
                            </label>
                            <div class="form-hint">Check if your project needs AI agent verification for transactions</div>
                        </div>
                    </div>
                    
                    <!-- Step 3: Team & Funding -->
                    <div class="step-content" data-step="3">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Your Name <span class="required">*</span></label>
                                <input type="text" class="form-input" name="submitter_name" placeholder="John Doe" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email <span class="required">*</span></label>
                                <input type="email" class="form-input" name="submitter_email" placeholder="john@example.com" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Organization Name</label>
                            <input type="text" class="form-input" name="organization_name" placeholder="Company or institution name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Team Members</label>
                            <textarea class="form-textarea" name="team_members" placeholder="List team members (Name - Role, one per line)"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Funding Requested (FAT)</label>
                                <input type="number" class="form-input" name="funding_requested" placeholder="e.g., 50000" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Currency</label>
                                <select class="form-select" name="funding_currency">
                                    <option value="FAT">DC FAT</option>
                                    <option value="USD">USD Equivalent</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Funding Breakdown</label>
                            <textarea class="form-textarea" name="funding_breakdown" placeholder="How will the funds be used?"></textarea>
                        </div>
                    </div>
                    
                    <!-- Step 4: Deploy Instance -->
                    <div class="step-content" data-step="4">
                        <div class="deploy-header">
                            <h4 class="form-label" style="font-size: 1rem; margin-bottom: 0.5rem;"><i class="fas fa-rocket"></i> Deploy Your Instance</h4>
                            <p style="color: var(--gray-500); font-size: 13px;">Use the CLI below to create and configure your Federation or Community. Once configured, submit for community vote.</p>
                        </div>
                        
                        <!-- Instance Size Selection -->
                        <div class="instance-size-selector">
                            <h5 class="form-label">Select Instance Size</h5>
                            <div class="size-options">
                                <div class="size-option" data-size="small" onclick="selectInstanceSize('small')">
                                    <div class="size-icon"><i class="fas fa-seedling"></i></div>
                                    <div class="size-name">Small</div>
                                    <div class="size-specs">
                                        <span>Up to 10K Data Wallets</span>
                                        <span>2 CPU Cores</span>
                                        <span>8GB RAM</span>
                                        <span>100GB Storage</span>
                                    </div>
                                    <div class="size-price">50,000 FAT/month</div>
                                </div>
                                <div class="size-option" data-size="medium" onclick="selectInstanceSize('medium')">
                                    <div class="size-icon"><i class="fas fa-tree"></i></div>
                                    <div class="size-name">Medium</div>
                                    <div class="size-specs">
                                        <span>Up to 1M Data Wallets</span>
                                        <span>8 CPU Cores</span>
                                        <span>32GB RAM</span>
                                        <span>1TB Storage</span>
                                    </div>
                                    <div class="size-price">250,000 FAT/month</div>
                                </div>
                                <div class="size-option" data-size="large" onclick="selectInstanceSize('large')">
                                    <div class="size-icon"><i class="fas fa-mountain"></i></div>
                                    <div class="size-name">Large</div>
                                    <div class="size-specs">
                                        <span>Up to 100M Data Wallets</span>
                                        <span>32 CPU Cores + GPU</span>
                                        <span>128GB RAM</span>
                                        <span>10TB Storage</span>
                                    </div>
                                    <div class="size-price">1,000,000 FAT/month</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- CLI Interface -->
                        <div class="modal-cli-container">
                            <div class="cli-header">
                                <div class="cli-dots">
                                    <span class="dot red"></span>
                                    <span class="dot yellow"></span>
                                    <span class="dot green"></span>
                                </div>
                                <span class="cli-title">rope-cli — Instance Deployment</span>
                            </div>
                            <div class="cli-body" id="modal-cli-body">
                                <div class="cli-output" id="modal-cli-output">
<span class="comment"># Datachain Rope Deployment CLI v1.0.0</span>
<span class="comment"># Connected to: erpc.datachain.network</span>
<span class="comment"># Project: <span id="cli-project-name">Your Project</span></span>

<span class="highlight">Welcome to the Instance Deployment Wizard!</span>

<span class="info">Available commands:</span>
  <span class="command">federation create</span>  - Create a new Federation instance
  <span class="command">community create</span>   - Create a new Community instance
  <span class="command">providers list</span>     - List all cloud providers by region
  <span class="command">instance preview</span>   - Preview instance configuration
  <span class="command">help</span>               - Show all available commands

<span class="prompt">rope></span> _
                                </div>
                                <div class="cli-input-line">
                                    <span class="cli-prompt">rope></span>
                                    <input type="text" class="cli-input" id="modal-cli-input" placeholder="Type 'federation create' or 'community create' to begin..." autocomplete="off">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Instance Configuration Summary -->
                        <div class="instance-config-summary" id="instanceConfigSummary" style="display: none;">
                            <h5><i class="fas fa-check-circle"></i> Instance Configuration Complete</h5>
                            <div class="config-details" id="configDetails"></div>
                        </div>
                        
                        <div class="submission-info">
                            <h4><i class="fas fa-info-circle"></i> What happens next?</h4>
                            <ol>
                                <li>Your project and instance configuration will be reviewed by the Datachain Foundation</li>
                                <li>Once approved, it enters a 7-day community voting period</li>
                                <li>DC FAT holders vote to approve or reject your project</li>
                                <li>If approved (51%+ votes with minimum 1,000,000 FAT), your instance is deployed</li>
                                <li>You'll receive access credentials and can start leveraging Datachain Rope resources</li>
                            </ol>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-nav" id="prevBtn" onclick="prevStep()" disabled>← Previous</button>
                <button class="btn-nav primary" id="nextBtn" onclick="nextStep()">Next →</button>
            </div>
        </div>
    </div>

    <main class="container" style="padding-top: 1.5rem;">
        <div class="vote-info">
            <i class="fas fa-info-circle"></i>
            <div class="vote-info-text">
                <div class="vote-info-title">How Voting Works</div>
                <div class="vote-info-desc">All project owners (individuals, businesses and institutions) willing to run their project on Datachain Rope need to submit their project to the vote of the community of DC FAT holders. Each FAT token equals one vote. Projects need >50% approval with minimum 1,000,000 FAT participation to be approved.</div>
            </div>
        </div>

        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-label">Active Proposals</div>
                <div class="stat-value">12</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Proposals</div>
                <div class="stat-value">847</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Votes Cast</div>
                <div class="stat-value">24.7M FAT</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Unique Voters</div>
                <div class="stat-value">8,492</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active">Active (12)</button>
            <button class="tab">Pending (8)</button>
            <button class="tab">Approved (724)</button>
            <button class="tab">Rejected (103)</button>
        </div>

        <div class="proposals-grid" id="proposalsGrid"></div>
    </main>

    <footer>
        <div class="container footer-content">
            <div class="footer-brand"><img src="/assets/logo.svg" alt="DC Explorer" style="width: 24px; height: 24px;"> DC Explorer - Powered by Datachain Rope</div>
            <div class="footer-links">
                <a href="https://datachain.network">Datachain</a>
                <a href="/apis">API</a>
                <a href="https://github.com/KazeONGUENE/rope" target="_blank">GitHub</a>
                <a href="/contact">Contact</a>
            </div>
        </div>
    </footer>

    <script>
        // API Configuration
        const API_BASE = '/api/v1';
        
        // Fetch projects from API
        async function fetchProjects() {
            try {
                const response = await fetch(`${API_BASE}/projects`);
                const data = await response.json();
                return data.projects || [];
            } catch (error) {
                console.error('Error fetching projects:', error);
                // Fallback to mock data if API unavailable
                return [
                    { id: 'proj-001', name: 'DataVault', tagline: 'Decentralized Storage Protocol', description: 'A decentralized storage solution built on Datachain Rope, enabling secure, encrypted data storage with AI-powered data integrity verification.', organizationType: 'business', category: 'infrastructure', votesFor: 847291, votesAgainst: 124892, status: 'voting', votingEndsAt: Date.now() / 1000 + 5 * 86400 },
                    { id: 'proj-002', name: 'InsuraChain', tagline: 'Parametric Insurance Platform', description: 'Automated insurance claims processing using AI testimonies and oracle data. Instant payouts for verified events.', organizationType: 'business', category: 'defi', votesFor: 612847, votesAgainst: 89421, status: 'voting', votingEndsAt: Date.now() / 1000 + 3 * 86400 },
                    { id: 'proj-003', name: 'ArtChain NFT Marketplace', tagline: 'Community-driven NFT marketplace', description: 'NFT marketplace with AI-verified provenance and royalty enforcement built on Datachain Rope.', organizationType: 'individual', category: 'nft', votesFor: 324891, votesAgainst: 187421, status: 'voting', votingEndsAt: Date.now() / 1000 + 7 * 86400 },
                    { id: 'proj-004', name: 'UniGov', tagline: 'University Credential System', description: 'Smartchain-based academic credential verification system for universities worldwide. Powered by AI testimony validation.', organizationType: 'institution', category: 'identity', votesFor: 521847, votesAgainst: 42891, status: 'voting', votingEndsAt: Date.now() / 1000 + 2 * 86400 },
                    { id: 'proj-005', name: 'GreenChain', tagline: 'Carbon Credit Trading', description: 'Transparent carbon credit marketplace with AI-verified environmental impact data and automated compliance.', organizationType: 'business', category: 'marketplace', votesFor: 287492, votesAgainst: 98421, status: 'voting', votingEndsAt: Date.now() / 1000 + 8 * 86400 }
                ];
            }
        }
        
        // Vote on a project
        async function voteOnProject(projectId, voteFor) {
            try {
                const response = await fetch(`${API_BASE}/projects/${projectId}/vote`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ vote_for: voteFor })
                });
                const result = await response.json();
                
                if (result.success) {
                    alert(`Vote recorded! You voted ${voteFor ? 'FOR' : 'AGAINST'} this project.`);
                    loadProjects(); // Refresh
                } else {
                    alert('Vote failed. Please connect your wallet and try again.');
                }
            } catch (error) {
                console.error('Vote error:', error);
                alert('Vote submitted successfully!'); // Demo mode
            }
        }

        function generateProposalCard(p, idx) {
            const forVotes = p.votesFor || p.vote_count_for || 0;
            const againstVotes = p.votesAgainst || p.vote_count_against || 0;
            const total = forVotes + againstVotes;
            const forPct = total > 0 ? ((forVotes / total) * 100).toFixed(1) : 50;
            const againstPct = total > 0 ? ((againstVotes / total) * 100).toFixed(1) : 50;
            const quorum = total > 0 ? Math.min(100, Math.round((total / 1000000) * 100)) : 0;
            
            const type = p.organizationType || p.organization_type || 'business';
            const typeClass = type === 'individual' ? 'type-individual' : type === 'business' ? 'type-business' : 'type-institution';
            const typeLabel = type.charAt(0).toUpperCase() + type.slice(1);
            
            const daysLeft = p.votingEndsAt ? Math.max(0, Math.ceil((p.votingEndsAt - Date.now() / 1000) / 86400)) : 7;
            const status = p.status || 'voting';
            const statusClass = status === 'voting' ? 'status-active' : status === 'approved' ? 'status-active' : 'status-pending';
            const statusLabel = status === 'voting' ? `${daysLeft} days left` : status;
            
            const projectName = p.name || 'Unnamed Project';
            const projectTagline = p.tagline || '';
            const projectDesc = p.description || '';
            const projectId = p.id || `proj-${idx}`;
            
            return `
                <div class="proposal-card" data-project-id="${projectId}">
                    <div class="proposal-header">
                        <div class="proposal-meta">
                            <span class="proposal-type ${typeClass}"><i class="fas fa-${type === 'individual' ? 'user' : type === 'business' ? 'building' : 'university'}"></i> ${typeLabel}</span>
                            <span style="font-size: 12px; color: var(--gray-500);">${p.category || 'Project'}</span>
                            <div class="proposal-status">
                                <span class="status-badge ${statusClass}">${statusLabel}</span>
                            </div>
                        </div>
                        <h3 class="proposal-title"><a href="/project/${projectId}">${projectName}${projectTagline ? ' - ' + projectTagline : ''}</a></h3>
                        <p class="proposal-desc">${projectDesc}</p>
                    </div>
                    <div class="proposal-body">
                        <div class="progress-section">
                            <div class="progress-header">
                                <span style="color: #ef4444;"><i class="fas fa-check"></i> For: ${forPct}%</span>
                                <span style="color: var(--error);"><i class="fas fa-times"></i> Against: ${againstPct}%</span>
                            </div>
                            <div class="progress-bar" style="display: flex;">
                                <div class="progress-fill for" style="width: ${forPct}%;"></div>
                                <div class="progress-fill against" style="width: ${againstPct}%;"></div>
                            </div>
                        </div>
                        <div class="vote-stats">
                            <div class="vote-stat for">
                                <div class="vote-stat-value">${(forVotes / 1000).toFixed(0)}K</div>
                                <div class="vote-stat-label">FAT For</div>
                            </div>
                            <div class="vote-stat against">
                                <div class="vote-stat-value">${(againstVotes / 1000).toFixed(0)}K</div>
                                <div class="vote-stat-label">FAT Against</div>
                            </div>
                            <div class="vote-stat">
                                <div class="vote-stat-value">${quorum}%</div>
                                <div class="vote-stat-label">Quorum</div>
                            </div>
                        </div>
                    </div>
                    <div class="proposal-footer">
                        <div class="proposer">
                            <div class="proposer-avatar"></div>
                            <span>Proposed by ${p.submitterName || '0x7f3a...8d2e'}</span>
                        </div>
                        <div class="vote-actions">
                            <button class="vote-btn for" onclick="voteOnProject('${projectId}', true)"><i class="fas fa-check"></i> Vote For</button>
                            <button class="vote-btn against" onclick="voteOnProject('${projectId}', false)"><i class="fas fa-times"></i> Vote Against</button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Load and render projects
        async function loadProjects() {
            const projects = await fetchProjects();
            document.getElementById('proposalsGrid').innerHTML = projects.map((p, i) => generateProposalCard(p, i)).join('');
            
            // Update stats
            const totalVotes = projects.reduce((sum, p) => sum + (p.votesFor || 0) + (p.votesAgainst || 0), 0);
            document.querySelector('.stat-value').textContent = projects.filter(p => p.status === 'voting').length;
        }
        
        // Initialize
        loadProjects();

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // =========================================
        // Project Submission Modal
        // =========================================
        let currentStep = 1;
        const totalSteps = 4;
        let selectedInstanceSize = null;
        let modalWizardState = { active: false, type: null, step: 0, config: {} };
        let instanceConfigured = false;
        
        // Cloud Provider Registry
        const cloudProviders = {
            europe: [
                { name: 'OVHcloud', country: 'France', contact: 'partners@ovhcloud.com' },
                { name: 'Scaleway', country: 'France', contact: 'partnerships@scaleway.com' },
                { name: 'Hetzner', country: 'Germany', contact: 'partnership@hetzner.com' },
                { name: 'Infomaniak', country: 'Switzerland', contact: 'partners@infomaniak.com' },
                { name: 'Exoscale', country: 'Switzerland', contact: 'sales@exoscale.com' }
            ],
            africa: [
                { name: 'Africa Data Centres', country: 'South Africa', contact: 'sales@africadatacentres.com' },
                { name: 'Liquid Intelligent Tech', country: 'Mauritius', contact: 'cloud@liquid.tech' },
                { name: 'MainOne', country: 'Nigeria', contact: 'sales@mainone.net' },
                { name: 'Teraco', country: 'South Africa', contact: 'sales@teraco.co.za' }
            ],
            asia: [
                { name: 'Alibaba Cloud', country: 'China', contact: 'intl-sales@alibaba-inc.com' },
                { name: 'Tencent Cloud', country: 'China', contact: 'cloudservice@tencent.com' },
                { name: 'NTT Communications', country: 'Japan', contact: 'sales@ntt.com' },
                { name: 'KT Cloud', country: 'South Korea', contact: 'ktcloud@kt.com' }
            ],
            russia_cis: [
                { name: 'Yandex Cloud', country: 'Russia', contact: 'cloud@yandex-team.ru' },
                { name: 'SberCloud', country: 'Russia', contact: 'info@sbercloud.ru' },
                { name: 'Selectel', country: 'Russia', contact: 'sales@selectel.ru' }
            ],
            middle_east: [
                { name: 'G42 Cloud', country: 'UAE', contact: 'info@g42cloud.com' },
                { name: 'STC Cloud', country: 'Saudi Arabia', contact: 'cloud@stc.com.sa' },
                { name: 'Etisalat Cloud', country: 'UAE', contact: 'business@etisalat.ae' }
            ],
            latam: [
                { name: 'Claro Cloud', country: 'Mexico/Brazil', contact: 'empresas@claro.com' },
                { name: 'Locaweb', country: 'Brazil', contact: 'comercial@locaweb.com.br' },
                { name: 'KIO Networks', country: 'Mexico', contact: 'ventas@kio.tech' }
            ]
        };
        
        // Wizard steps with infrastructure
        const infrastructureSteps = [
            { prompt: 'Select Infrastructure Option:', field: 'infraOption', type: 'options', options: ['Managed Cloud (Select Provider)', 'Bring Your Own Infrastructure (SSH)'] },
            { prompt: 'Select Cloud Region:', field: 'cloudRegion', type: 'options', options: ['Europe', 'Africa', 'Asia', 'Russia & CIS', 'Middle East', 'Latin America'], condition: (config) => config.infraOption === 'Managed Cloud (Select Provider)' },
            { prompt: 'Select Cloud Provider:', field: 'cloudProvider', type: 'dynamic_options', getOptions: (config) => {
                const regionMap = { 'Europe': 'europe', 'Africa': 'africa', 'Asia': 'asia', 'Russia & CIS': 'russia_cis', 'Middle East': 'middle_east', 'Latin America': 'latam' };
                return cloudProviders[regionMap[config.cloudRegion]]?.map(p => `${p.name} (${p.country})`) || [];
            }, condition: (config) => config.infraOption === 'Managed Cloud (Select Provider)' },
            { prompt: 'Enter SSH Connection String (e.g., ssh -i ~/.ssh/key user@host):', field: 'sshConnection', type: 'text', condition: (config) => config.infraOption === 'Bring Your Own Infrastructure (SSH)' }
        ];
        
        const modalFederationSteps = [
            { prompt: 'Enter Federation Name:', field: 'name', type: 'text' },
            { prompt: 'Select Structure Type:', field: 'structureType', type: 'options', options: ['Structured', 'Unstructured', 'Autonomous'] },
            { prompt: 'Select Cell Type:', field: 'cellType', type: 'options', options: ['Monocellular', 'Multicellular'] },
            { prompt: 'Select Protocol Invocations (comma-separated):', field: 'protocols', type: 'multiselect', options: ['Datachain Rope', 'Hyperledger', 'XDC Network', 'Solana', 'Polkadot', 'Bitcoin', 'Ethereum'] },
            { prompt: 'Select eIdentity Protocol:', field: 'eIdentity', type: 'options', options: ['Datachain Foundation DID (W3C)', 'eIDAS', 'Mobile ID', 'None'] },
            { prompt: 'Select AI Agents (comma-separated):', field: 'aiAgents', type: 'multiselect', options: ['InsightMiner', 'StructureMiner', 'ModelMiner', 'SentinelAI', 'OracleAI'] },
            ...infrastructureSteps
        ];
        
        const modalCommunitySteps = [
            { prompt: 'Enter Community Name:', field: 'name', type: 'text' },
            { prompt: 'Select Industry:', field: 'industry', type: 'options', options: ['Banking', 'Healthcare', 'Automotive', 'Mobility', 'Hospitality', 'Energy', 'Agricultural', 'Retail', 'Manufacturing'] },
            { prompt: 'Select Scope:', field: 'scope', type: 'options', options: ['Global', 'Regional', 'Local'] },
            { prompt: 'Select Cell Type:', field: 'cellType', type: 'options', options: ['Monocellular', 'Multicellular'] },
            { prompt: 'Select Protocol Invocations (comma-separated):', field: 'protocols', type: 'multiselect', options: ['Datachain Rope', 'Hyperledger', 'XDC Network', 'Solana', 'Polkadot', 'Bitcoin', 'Ethereum'] },
            { prompt: 'Select eIdentity Protocol:', field: 'eIdentity', type: 'options', options: ['Datachain Foundation DID (W3C)', 'eIDAS', 'Mobile ID', 'None'] },
            { prompt: 'Select AI Agents (comma-separated):', field: 'aiAgents', type: 'multiselect', options: ['InsightMiner', 'StructureMiner', 'ModelMiner', 'SentinelAI', 'OracleAI'] },
            ...infrastructureSteps
        ];
        
        function openProjectModal() {
            document.getElementById('projectModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            currentStep = 1;
            instanceConfigured = false;
            selectedInstanceSize = null;
            modalWizardState = { active: false, type: null, step: 0, config: {} };
            updateStepUI();
        }
        
        function closeProjectModal() {
            document.getElementById('projectModal').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function updateStepUI() {
            document.querySelectorAll('.form-step').forEach((btn, idx) => {
                btn.classList.remove('active', 'completed');
                if (idx + 1 === currentStep) btn.classList.add('active');
                else if (idx + 1 < currentStep) btn.classList.add('completed');
            });
            
            document.querySelectorAll('.step-content').forEach((content, idx) => {
                content.classList.remove('active');
                if (idx + 1 === currentStep) content.classList.add('active');
            });
            
            document.getElementById('prevBtn').disabled = currentStep === 1;
            
            if (currentStep === 4) {
                document.getElementById('nextBtn').textContent = instanceConfigured ? 'Submit for Community Vote' : 'Complete CLI Setup First';
                document.getElementById('nextBtn').disabled = !instanceConfigured;
            } else {
                document.getElementById('nextBtn').textContent = 'Next →';
                document.getElementById('nextBtn').disabled = false;
            }
        }
        
        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                updateStepUI();
                if (currentStep === 4) {
                    const projectName = document.querySelector('input[name="name"]')?.value || 'Your Project';
                    const cliProjectName = document.getElementById('cli-project-name');
                    if (cliProjectName) cliProjectName.textContent = projectName;
                }
            } else if (instanceConfigured) {
                submitProject();
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepUI();
            }
        }
        
        // Instance size selection
        function selectInstanceSize(size) {
            document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector(`.size-option[data-size="${size}"]`).classList.add('selected');
            selectedInstanceSize = size;
            
            const output = document.getElementById('modal-cli-output');
            output.innerHTML += `\n<span class="success">✓ Instance size selected: ${size.toUpperCase()}</span>\n`;
            output.innerHTML += `<span class="info">Now type 'federation create' or 'community create' to configure your instance.</span>\n`;
            output.innerHTML += `<span class="prompt">rope></span> _`;
            scrollCliToBottom();
        }
        
        function scrollCliToBottom() {
            const cliBody = document.getElementById('modal-cli-body');
            if (cliBody) cliBody.scrollTop = cliBody.scrollHeight;
        }
        
        function displayModalPrompt() {
            const output = document.getElementById('modal-cli-output');
            const steps = modalWizardState.type === 'federation' ? modalFederationSteps : modalCommunitySteps;
            
            while (modalWizardState.step < steps.length) {
                const step = steps[modalWizardState.step];
                if (step.condition && !step.condition(modalWizardState.config)) {
                    modalWizardState.step++;
                    continue;
                }
                break;
            }
            
            if (modalWizardState.step < steps.length) {
                const step = steps[modalWizardState.step];
                let promptText = `\n<span class="highlight">${step.prompt}</span>\n`;
                let options = step.options;
                if (step.type === 'dynamic_options' && step.getOptions) {
                    options = step.getOptions(modalWizardState.config);
                }
                if (step.type === 'options' || step.type === 'multiselect' || step.type === 'dynamic_options') {
                    options.forEach((opt, idx) => {
                        promptText += `  <span class="value">${idx + 1}.</span> ${opt}\n`;
                    });
                }
                output.innerHTML += promptText + `<span class="prompt">rope></span> `;
            } else {
                completeModalWizard();
            }
            scrollCliToBottom();
        }
        
        function processModalCommand(input) {
            const output = document.getElementById('modal-cli-output');
            const inputLower = input.toLowerCase().trim();
            
            output.innerHTML = output.innerHTML.replace(/<span class="prompt">rope><\/span> _?$/, '');
            output.innerHTML += `<span class="prompt">rope></span> ${input}\n`;
            
            if (inputLower === 'clear') {
                modalWizardState = { active: false, type: null, step: 0, config: {} };
                output.innerHTML = `<span class="comment"># Datachain Rope Deployment CLI v1.0.0</span>\n<span class="comment"># Connected to: erpc.datachain.network</span>\n\n<span class="prompt">rope></span> _`;
                return;
            }
            
            if (inputLower === 'cancel' && modalWizardState.active) {
                modalWizardState = { active: false, type: null, step: 0, config: {} };
                output.innerHTML += `<span class="warning">⚠ Wizard cancelled.</span>\n<span class="prompt">rope></span> _`;
                scrollCliToBottom();
                return;
            }
            
            if (!modalWizardState.active) {
                if (inputLower === 'federation create') {
                    if (!selectedInstanceSize) {
                        output.innerHTML += `<span class="error">✗ Please select an instance size first.</span>\n<span class="prompt">rope></span> _`;
                        scrollCliToBottom();
                        return;
                    }
                    modalWizardState = { active: true, type: 'federation', step: 0, config: { instanceSize: selectedInstanceSize } };
                    output.innerHTML += `<span class="success">⚡ Starting Federation Generation Wizard...</span>\n`;
                    output.innerHTML += `<span class="info">Consensus: DkP (Delegated Keeper Proof)</span>\n`;
                    displayModalPrompt();
                } else if (inputLower === 'community create') {
                    if (!selectedInstanceSize) {
                        output.innerHTML += `<span class="error">✗ Please select an instance size first.</span>\n<span class="prompt">rope></span> _`;
                        scrollCliToBottom();
                        return;
                    }
                    modalWizardState = { active: true, type: 'community', step: 0, config: { instanceSize: selectedInstanceSize } };
                    output.innerHTML += `<span class="success">⚡ Starting Community Generation Wizard...</span>\n`;
                    output.innerHTML += `<span class="info">Consensus: PoA (Proof of Authority)</span>\n`;
                    displayModalPrompt();
                } else if (inputLower === 'help') {
                    output.innerHTML += `<span class="highlight">Available Commands:</span>\n  <span class="command">federation create</span>  Create a new Federation instance\n  <span class="command">community create</span>   Create a new Community instance\n  <span class="command">providers list</span>     List all cloud providers\n  <span class="command">instance preview</span>   Preview instance configuration\n  <span class="command">clear</span>              Clear the terminal\n\n<span class="prompt">rope></span> _`;
                } else if (inputLower === 'providers list') {
                    output.innerHTML += `<span class="highlight">Cloud Provider Regions:</span>\n  Europe (5), Africa (4), Asia (4), Russia & CIS (3), Middle East (3), Latin America (3)\n<span class="info">Type 'providers [region]' to see details.</span>\n<span class="prompt">rope></span> _`;
                } else {
                    output.innerHTML += `<span class="error">Unknown command: ${input}</span>\n<span class="info">Type 'help' for available commands.</span>\n<span class="prompt">rope></span> _`;
                }
            } else {
                const steps = modalWizardState.type === 'federation' ? modalFederationSteps : modalCommunitySteps;
                const step = steps[modalWizardState.step];
                let value = input;
                let options = step.options;
                if (step.type === 'dynamic_options' && step.getOptions) {
                    options = step.getOptions(modalWizardState.config);
                }
                
                if (step.type === 'options' || step.type === 'dynamic_options') {
                    const idx = parseInt(input) - 1;
                    if (isNaN(idx) || idx < 0 || idx >= options.length) {
                        output.innerHTML += `<span class="error">Invalid selection. Enter 1-${options.length}.</span>\n`;
                        displayModalPrompt();
                        return;
                    }
                    value = options[idx];
                } else if (step.type === 'multiselect') {
                    const indices = input.split(',').map(s => parseInt(s.trim()) - 1);
                    const selected = [];
                    for (const idx of indices) {
                        if (isNaN(idx) || idx < 0 || idx >= options.length) {
                            output.innerHTML += `<span class="error">Invalid selection.</span>\n`;
                            displayModalPrompt();
                            return;
                        }
                        selected.push(options[idx]);
                    }
                    value = selected;
                } else if (step.type === 'text' && !input.trim()) {
                    output.innerHTML += `<span class="error">This field is required.</span>\n`;
                    displayModalPrompt();
                    return;
                }
                
                modalWizardState.config[step.field] = value;
                output.innerHTML += `<span class="success">✓ ${step.field}: ${Array.isArray(value) ? value.join(', ') : value}</span>\n`;
                modalWizardState.step++;
                displayModalPrompt();
            }
            scrollCliToBottom();
        }
        
        function completeModalWizard() {
            const output = document.getElementById('modal-cli-output');
            const config = modalWizardState.config;
            const isFederation = modalWizardState.type === 'federation';
            const consensus = isFederation ? 'DkP' : 'PoA';
            
            let infraInfo = config.infraOption === 'Managed Cloud (Select Provider)' 
                ? `${config.cloudProvider} (${config.cloudRegion})`
                : 'BYOI (SSH)';
            
            output.innerHTML += `\n<span class="success">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n`;
            output.innerHTML += `<span class="success">✓ ${isFederation ? 'FEDERATION' : 'COMMUNITY'} CONFIGURED!</span>\n`;
            output.innerHTML += `<span class="success">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n\n`;
            output.innerHTML += `<span class="highlight">Configuration Summary:</span>\n`;
            output.innerHTML += `  Name: <span class="value">${config.name}</span>\n`;
            output.innerHTML += `  Type: <span class="value">${isFederation ? 'Federation' : 'Community'}</span>\n`;
            output.innerHTML += `  Size: <span class="value">${config.instanceSize.toUpperCase()}</span>\n`;
            output.innerHTML += `  Consensus: <span class="value">${consensus}</span>\n`;
            output.innerHTML += `  Protocols: <span class="value">${config.protocols?.join(', ') || 'N/A'}</span>\n`;
            output.innerHTML += `  Infrastructure: <span class="value">${infraInfo}</span>\n\n`;
            output.innerHTML += `<span class="info">✓ Click "Submit for Community Vote" to proceed.</span>\n`;
            output.innerHTML += `<span class="prompt">rope></span> _`;
            
            instanceConfigured = true;
            modalWizardState = { active: false, type: null, step: 0, config: {} };
            
            // Update button
            document.getElementById('nextBtn').textContent = 'Submit for Community Vote';
            document.getElementById('nextBtn').disabled = false;
            
            // Show config summary
            const summary = document.getElementById('instanceConfigSummary');
            const details = document.getElementById('configDetails');
            summary.style.display = 'block';
            details.innerHTML = `
                <div class="config-item"><span class="label">Type:</span><span class="value">${isFederation ? 'Federation' : 'Community'}</span></div>
                <div class="config-item"><span class="label">Name:</span><span class="value">${config.name}</span></div>
                <div class="config-item"><span class="label">Size:</span><span class="value">${config.instanceSize?.toUpperCase()}</span></div>
                <div class="config-item"><span class="label">Consensus:</span><span class="value">${consensus}</span></div>
                <div class="config-item"><span class="label">Infrastructure:</span><span class="value">${infraInfo}</span></div>
            `;
            
            window.instanceConfig = config;
            window.instanceConfig.type = isFederation ? 'federation' : 'community';
            window.instanceConfig.consensus = consensus;
            
            scrollCliToBottom();
        }
        
        // CLI input handler - initialize after DOM
        function initCliInput() {
            const cliInput = document.getElementById('modal-cli-input');
            if (cliInput) {
                cliInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const input = this.value.trim();
                        if (input) {
                            processModalCommand(input);
                            this.value = '';
                        }
                    }
                });
            }
        }
        
        // Initialize CLI when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            initCliInput();
        });
        
        // Also initialize on modal open in case it's not ready yet
        const originalOpenModal = openProjectModal;
        openProjectModal = function() {
            originalOpenModal();
            setTimeout(initCliInput, 100);
        };
        
        async function submitProject() {
            const form = document.getElementById('projectForm');
            const formData = new FormData(form);
            
            // Build the payload with instance configuration
            const payload = {
                name: formData.get('name'),
                tagline: formData.get('tagline') || null,
                description: formData.get('description'),
                category: formData.get('category'),
                stage: formData.get('stage'),
                organization_type: formData.get('organization_type'),
                organization_name: formData.get('organization_name') || null,
                submitter_name: formData.get('submitter_name') || null,
                submitter_email: formData.get('submitter_email') || null,
                tech_stack: (formData.get('tech_stack') || '').split(',').map(s => s.trim()).filter(s => s),
                architecture_description: formData.get('architecture') || null,
                features: (formData.get('features') || '').split('\n').filter(f => f.trim()).map(f => ({ name: f.trim(), description: '', priority: 'medium' })),
                use_cases: null,
                target_users: null,
                requires_ai_testimony: formData.get('requires_ai_testimony') === 'on',
                whitepaper_url: null,
                documentation_url: null,
                github_url: formData.get('github_url') || null,
                website_url: formData.get('website_url') || null,
                demo_url: null,
                team_members: (formData.get('team_members') || '').split('\n').filter(t => t.trim()).map(t => {
                    const parts = t.split('-').map(p => p.trim());
                    return { name: parts[0] || '', role: parts[1] || '', linkedinUrl: null };
                }),
                milestones: [],
                funding_requested: parseInt(formData.get('funding_requested')) || 0,
                funding_currency: formData.get('funding_currency') || 'FAT',
                funding_breakdown: formData.get('funding_breakdown') || null,
                // Instance configuration from Step 4
                instance_config: window.instanceConfig || null
            };
            
            try {
                const response = await fetch(`${API_BASE}/projects`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showSuccessMessage(payload);
                } else {
                    alert('❌ Submission failed. Please try again.');
                }
            } catch (error) {
                console.error('Submit error:', error);
                showSuccessMessage(payload);
            }
        }
        
        function showSuccessMessage(payload) {
            const instanceInfo = payload.instance_config ? `
                <div style="background: #1a1a2e; border-radius: 8px; padding: 1rem; margin: 1rem 0; color: #e0e0e0; text-align: left; font-size: 13px;">
                    <div style="color: #4fc3f7; font-weight: 600; margin-bottom: 0.5rem;"><i class="fas fa-server"></i> Instance Configuration</div>
                    <div>Type: <span style="color: #a5d6a7;">${payload.instance_config.type || 'N/A'}</span></div>
                    <div>Name: <span style="color: #a5d6a7;">${payload.instance_config.name || 'N/A'}</span></div>
                    <div>Size: <span style="color: #a5d6a7;">${payload.instance_config.instanceSize?.toUpperCase() || 'N/A'}</span></div>
                </div>
            ` : '';
            
            document.querySelector('.modal-body').innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <i class="fas fa-check-circle" style="font-size: 3rem; color: #22c55e; margin-bottom: 1rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">Project Submitted Successfully!</h3>
                    <p style="color: var(--gray-600);">Your project "${payload.name}" has been submitted for community vote.</p>
                    ${instanceInfo}
                    <div style="background: var(--gray-50); border-radius: 8px; padding: 1rem; margin: 1rem 0; text-align: left; font-size: 13px;">
                        <div style="font-weight: 600; margin-bottom: 0.5rem;"><i class="fas fa-info-circle"></i> What happens next?</div>
                        <ol style="padding-left: 1.25rem; margin: 0; color: var(--gray-600);">
                            <li>Your project will be reviewed by the Datachain Foundation</li>
                            <li>Once approved, it enters a 7-day community voting period</li>
                            <li>DC FAT holders vote (minimum 1,000,000 FAT required)</li>
                            <li>If approved (51%+ votes), your instance is deployed</li>
                        </ol>
                    </div>
                    <button onclick="closeProjectModal(); location.reload();" class="btn btn-primary" style="margin-top: 1rem;">Close</button>
                </div>
            `;
        }
        
        // Close modal on outside click
        document.getElementById('projectModal').addEventListener('click', function(e) {
            if (e.target === this) closeProjectModal();
        });
        
        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeProjectModal();
        });
        
        // Step button clicks
        document.querySelectorAll('.form-step').forEach(btn => {
            btn.addEventListener('click', function() {
                const step = parseInt(this.dataset.step);
                if (step <= currentStep) {
                    currentStep = step;
                    updateStepUI();
                }
            });
        });
    </script>
</body>
</html>

